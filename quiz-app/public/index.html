<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">

<title>Vanilla Quiz</title>

<!-- Mobile-friendly viewport -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />
<style>
 body {
  font-family: arial;
 }
 .slide {
  display: none;
 }
 .quiz-form, .results, .funnel {
  padding: 6em 0; 
  width: 60%;
  margin: 0 auto;
  text-align: center;
 }
 .quiz-form .toggle {
  background: #eee;
  display: inline-block;
  padding: 0.7em 1.1em;
  margin: 1em 0;
 }
 .quiz-form .toggle:hover {
  background: #ccc;
  cursor: pointer;
 }
 input[type="submit"], #retake-btn {
  background: #eee;
  border: 0px;
  font-size:0.9em;
  padding: 1.5em 2em;
 } 
 input[type="submit"]:hover, #retake-btn:hover {
  background: #333;
  color: #fff;
  cursor: pointer;
 } 
 fieldset {
  border: 0px;
 }
 legend {  
  width: 100%;
 }
 .quiz-form .active-toggle {
  background: #ccc;
 }
 .choices {
  font-size: 1.2em;  
 }
 .choices label {
  display: block;
  padding: 10px 10px;
  text-align: left;
 }
 .choices label:hover {
  background: #eee;
  cursor: pointer;
 }
 .results h2 {
  font-size: 1em;
 }
 .correct {
  color: #fff;
  background: green;
  padding: 10px 0;
  text-transform: uppercase;
 }
 .incorrect {
  color: #fff;
  background: red;
  padding: 10px 0;
  text-transform: uppercase;
 }
 .user-response {
  background: #eee;
  font-size: 1em;
  padding: 10px 0;
  margin: 0;
 }
 .funnel a {
  display: inline-block;
  color: #fff;
  padding: 50px 0;
  background: #3498db;
  float: left;
  font-size: 1.5em;
  text-decoration: none;
  width: 33.3%;
 }
 .funnel a:hover {
  background: #2980b9;
 }
</style>
</head>
<body>

<div class="funnel">
  <h1><i class="fa fa-cogs"></i> Front-End Engineering Prep</h1>
  <h2>What do you want to learn?</h2>
  <aside id="funnel-handle">
    <a href="#" class="html"><i class="fa fa-html5"></i> HTML5 </a>
    <a href="#" class="css"><i class="fa fa-css3"></i>CSS3 </a>
    <a href="#" class="javascript"><i class="fa fa-file"></i> EcmaScript6 </a>
  </aside>
</div>

 <form class="quiz-form" name="quiz-form">
  <div id="quiz"></div>
  
  <aside>
   <span class="toggle" onclick="moveSlide(1)">1</span> 
   <span class="toggle" onclick="moveSlide(2)">2</span> 
   <span class="toggle" onclick="moveSlide(3)">3</span> 
  </aside>

  <input type="submit" value="See Results" />
 </form>

 <div id="results" class="results">
 </div>

<script>
 var quizForm = document.forms['quiz-form'];
 var quiz = document.getElementById('quiz');
 var results = document.getElementById('results');
 var retakeBtn = document.getElementById('retake-btn');
 var funnelHandle = document.getElementById('funnel-handle');
 var funnel = document.querySelector('.funnel');
 var slideIndex = 1;

 // consider builder for quizData
 var quizData = [
  { 
   question: "What is the physical component where data is stored in a HDD?", 
   choices: { a:"Platter", b:"Cluster", c:"Read/write head"}, 
   answer: "a"
  },
  { 
   question: "Which pair represents the flow of power supplies and AC adapters?", 
   choices: { a:"DC in, AC out", b:"AC in, DC out", c:"AC in, AC out"}, 
   answer: "b"
  },
  { 
   question: "What tends to vary among power supplies in connectivity terms?", 
   choices: { a:"Amperage", b:"Wattage", c:"Voltage"}, 
   answer: "b"
  }
 ];

 funnelHandle.addEventListener('click', function(evt) {
  evt.preventDefault();


  funnel.style.display = 'none';
  quizForm.style.display = 'block';
 });

 // render quiz as soon as the page loads
 renderQuiz();
 renderSlides(1);

 quizForm.style.display = 'none';

 function renderQuiz() {
  var viewUpdate = buildQuizView();
  quiz.innerHTML = viewUpdate;
 }

 function buildQuizView() {
   var tempView = [];

   // Array.forEach tends to be slower
   // than the for() loop used here
   for (var i=0;i<quizData.length;i++) {
    var currentQues = quizData[i];
    var choicePos = i + 1
    var choices = [];

   for (choice in currentQues.choices) {     
     choices.push(
       `<label>
         <input type="radio" name="choice${i}" value="${choice}" />
         ${choice} : ${currentQues.choices[choice]}
       </label>`
     );
   }

    tempView.push(
     `
     <div class="slide">
     <fieldset>
      <legend>
       <h1>${choicePos} ${currentQues.question}</h1>
      </legend>
      <div class="choices">
       <p>${choices.join('')}
      </div>
     </fieldset>
     </div>     
     `
    );
   }

  return tempView.join('');
 }

 function renderSlides(index) {
  var slides = document.getElementsByClassName('slide');
  var toggles = document.getElementsByClassName('toggle');
  for (var i=0;i<slides.length;i++) {
    slides[i].style.display = 'none';
    toggles[i].className = toggles[i].className.replace(" active-toggle", "");
  }
  slides[index - 1].style.display = "block";
  toggles[index - 1].className += " active-toggle";
 }

 function moveSlide(userSlide) {  
  slideIndex = userSlide;
  renderSlides(userSlide);
 }

 quizForm.onsubmit = function(evt) {
  evt.preventDefault();

  var choiceDivs = quiz.querySelectorAll('.choices');
  var userChoices = [];

  // gather user choices
  for (var i=0;i<quizData.length;i++) {
   const temp = choiceDivs[i];
   const selector = `input[name=choice${i}]:checked`;      
   const userChoice = (temp.querySelector(selector) || {}).value;
   const userChoiceText = quizData[i].choices[userChoice];
   var relatedQues = quizData[i].question;
   var correctChoice = quizData[i].answer;
   var result = (userChoice === correctChoice) 
        ? '<div class="correct">Correct</div>' 
        : '<div class="incorrect">Incorrect</div>';

   userChoices.push(
    `
    <h2>
    ${i + 1} ${relatedQues}
    </h2>
    <p class="user-response">
    Response: ${userChoiceText}
    ${result}
    </p>
    `
   );
  
  }

  quizForm.style.display = 'none';
  results.style.display = 'block';

  results.innerHTML = '<h1>Quiz Results</h1>' 
                        + userChoices.join('') 
                        + '<button id="retake-btn">Retake Quiz</button>'

  document.getElementById('retake-btn').addEventListener('click', retryQuiz);

  function retryQuiz() {
    renderSlides(1);    
    quizForm.reset();    
    results.style.display = 'none';
    funnel.style.display = 'block';
  }

 }



</script>
</body>
</html>