<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">

<title>Vanilla Quiz</title>

<!-- Mobile-friendly viewport -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
 .slide {
  display: none;
 }
 .quiz-form, .results {
  padding: 3em;
  width: 65%;
  margin: 0 auto;
  text-align: center;
 }
 .quiz-form .toggle {
  background: #eee;
  display: inline-block;
  padding: 0.7em 1.1em;
  margin: 1em 0;
 }
 .quiz-form .toggle:hover {
  background: #ccc;
  cursor: pointer;
 }
 input[type="submit"], #retake-btn {
  background: #eee;
  border: 0px;
  font-size:0.9em;
  padding: 1.5em 2em;
 } 
 input[type="submit"]:hover, #retake-btn:hover {
  background: #333;
  color: #fff;
  cursor: pointer;
 } 
 fieldset {
  border: 0px;
 }
 legend {
  font-size: 1em;
  width: 100%;
 }
 .choices {
  font-size: 1.2em;  
 }
 .choices label {
  display: block;
  padding: 10px 10px;
  text-align: left;
 }
 .choices label:hover {
  background: #eee;
  cursor: pointer;
 }
</style>
</head>
<body>
 <form class="quiz-form" name="quiz-form">
  <div id="quiz"></div>
  
  <aside id="toggle-handle">
   <span class="toggle" onclick="moveSlide(1)">1</span> 
   <span class="toggle" onclick="moveSlide(2)">2</span> 
   <span class="toggle" onclick="moveSlide(3)">3</span> 
  </aside>

  <input type="submit" value="See Results" />
 </form>

 <div id="results" class="results">
 </div>

<script>
 var quizForm = document.forms['quiz-form'];
 var quiz = document.getElementById('quiz');
 var results = document.getElementById('results');
 var retakeBtn = document.getElementById('retake-btn');
 var toggleHandle = document.getElementById('toggle-handle');
 var slideIndex = 1;

 // consider builder for quizData
 var quizData = [
  { 
   question: "What is the physical component where data is stored in a HDD", 
   choices: { a:"Platter", b:"Cluster", c:"Read/write head"}, 
   answer: "a"
  },
  { 
   question: "Which pair represents the flow of power supplies and AC adapters?", 
   choices: { a:"DC in, AC out", b:"AC in, DC out", c:"AC in, AC out"}, 
   answer: "b"
  },
  { 
   question: "What tends to vary among power supplies?", 
   choices: { a:"Amperage", b:"Voltage", c:"Wattage"}, 
   answer: "c"
  }
 ];

 // render quiz as soon as the page loads
 renderQuiz();
 renderSlides(1);

 function renderQuiz() {
  var viewUpdate = buildQuizView();
  quiz.innerHTML = viewUpdate;
 }

 function buildQuizView() {
   var tempView = [];

   // Array.forEach tends to be slower
   // than the for() loop used here
   for (var i=0;i<quizData.length;i++) {
    var currentQues = quizData[i];
    var choicePos = i + 1
    var choices = [];

   for (choice in currentQues.choices) {     
     choices.push(
       `<label>
         <input type="radio" name="choice${i}" value="${choice}" />
         ${choice} : ${currentQues.choices[choice]}
       </label>`
     );
   }

    tempView.push(
     `
     <div class="slide">
     <fieldset>
      <legend>
       <h1>${choicePos} ${currentQues.question}</h1>
      </legend>
      <div class="choices">
       <p>${choices.join('')}
      </div>
     </fieldset>
     </div>     
     `
    );
   }

  return tempView.join('');
 }

 function renderSlides(index) {
  var slides = document.getElementsByClassName('slide');  
  for (var i=0;i<slides.length;i++) {
    slides[i].style.display = 'none';
  }

  console.log('input INDEX ', index);

  slides[index - 1].style.display = "block";   
 }

 function moveSlide(userSlide) {  
  slideIndex = userSlide;
  renderSlides(userSlide);
 }

 toggleHandle.addEventListener('click', function(evt) {  
  //evt.target.className += ' active'; 
  console.log(evt.target);
 });

 quizForm.onsubmit = function(evt) {
  evt.preventDefault();

  var choiceDivs = quiz.querySelectorAll('.choices');
  var userChoices = [];

  // gather user choices
  for (var i=0;i<quizData.length;i++) {
   const temp = choiceDivs[i];
   const selector = `input[name=choice${i}]:checked`;      
   const userChoice = (temp.querySelector(selector) || {}).value;
   const userChoiceText = quizData[i].choices[userChoice];
   var relatedQues = quizData[i].question;

   userChoices.push(
    `
    <h2>
    ${i + 1} ${relatedQues}
    </h2>
    <p>
    ${userChoiceText}
    </p>
    `
   );
  
  }

  quizForm.style.display = 'none';
  results.style.display = 'block';

  results.innerHTML = '<h1>Quiz Results</h1>' 
                        + userChoices.join('') 
                        + '<button id="retake-btn">Retake Quiz</button>'

  document.getElementById('retake-btn').addEventListener('click', retryQuiz);

  function retryQuiz() {    
    renderSlides(1);
    quizForm.reset();
    quizForm.style.display = 'block';
    results.style.display = 'none';
  }

 }



</script>
</body>
</html>